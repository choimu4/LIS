<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
	<title>Kakao 지도 시작하기</title>
	<style>
		/* 화면 전체를 차지하도록 스타일 설정 */
		html, body {
			width: 100%;
			height: 100%;
			margin: 0;
			padding: 0;
		}
		#map {
			width: 100%;
			height: 100%;
		}
		#current-location-btn {
			position: absolute;
			top: 10px;
			left: 10px;
			z-index: 1000;
			background-color: white;
			border: 1px solid #ccc;
			padding: 10px;
			cursor: pointer;
		}
	</style>
</head>
<body>
	<div id="map"></div>
	<button id="current-location-btn">현재 위치로 이동</button>
	<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=9f4efe1f08f0dc1b289457274270ae16&libraries=services"></script>
	<script>
		var container = document.getElementById('map');
		var options = {
			center: new kakao.maps.LatLng(33.450701, 126.570667),
			level: 3
		};

		var map = new kakao.maps.Map(container, options);
		var marker = null;
		var places = new kakao.maps.services.Places();

		document.getElementById('current-location-btn').addEventListener('click', function() {
			if (navigator.geolocation) {
				navigator.geolocation.getCurrentPosition(function(position) {
					var lat = position.coords.latitude;
					var lon = position.coords.longitude;
					var locPosition = new kakao.maps.LatLng(lat, lon);

					// 마커가 이미 존재하면 위치를 업데이트하고, 없으면 새로 생성합니다.
					if (marker) {
						marker.setPosition(locPosition);
					} else {
						marker = new kakao.maps.Marker({
							position: locPosition,
							map: map
						});
					}

					map.setCenter(locPosition);

					// 키워드를 검색하여 결과 위치에 마커를 표시합니다.
					var keywords = ['코인세탁소', '코인세탁방', '무인세탁소', '무인세탁방'];
					keywords.forEach(function(keyword) {
						places.keywordSearch(keyword, function(result, status) {
							if (status === kakao.maps.services.Status.OK) {
								for (var i = 0; i < result.length; i++) {
									var coords = new kakao.maps.LatLng(result[i].y, result[i].x);
									var placeMarker = new kakao.maps.Marker({
										position: coords,
										map: map
									});
								}
							}
						}, {
							location: locPosition,
							radius: 5000
						});
					});
				}, function(error) {
					alert('위치 정보를 가져오는데 실패했습니다.');
				});
			} else {
				alert('사용자의 브라우저는 Geolocation을 지원하지 않습니다.');
			}
		});
	</script>
</body>
</html>
